<!DOCTYPE html>
<html lung="jp">
<html>
  <head>
    <meta charset="UTF-8">
    <title>初年次の進化版のヤツ</title>
    <link rel="stylesheet" href="stylesheet.css">
  </head>
  <body>
    <h1>原発と私たち</h1>
    <br>
    <h2>1.はじめに</h2>
    <p1>
　    原子力発電と私たちというテーマで、原子力発電（以下、原発）の仕組みを整理した後、メリット、デメリットを挙げた後、賛否を問うた。
      私たちのグループは、創価大学における２年時 の領域選択で、応用物理を選択しようと考えてい る人が集まっているため、HP は物理に関連するものが良いと考えた．
</p1>
    <br>
  <h2>2.原発の仕組み</h2>
    <p1>原子力発電は、原子炉の中でウラン燃料が核分裂するときに出る熱で水を沸かして水蒸気を作り、この水蒸気の力でタービン(羽根車)を回し、連結している発電機で電気をつくります。
        タービンを回し終えた後の蒸気は復水器で冷やされて水に戻り、再び原子炉へ送られている。
        原子力発電は水の中に入った原子炉の中でウラン燃料が核分裂を起こして熱ができ、その熱で水を水蒸気に変えて、タービンを回して、電気を作っている。またウラン燃料は繰り返し使うことができます。
        また、原子力発電を作る場所は、特に固い岩盤が選ばれ、地震などに備えた何重もの安全対策をしています。
    </p1>
    <br>
    <h2>原発のメリット</h2>
    　　原発のメリットは3つあります
    　<ul>
        <li>発電時のCO₂排出量が少ない。</li>
        　　　原子力発電は、発電する際にCO₂を排出しません。発電設備の運用に少量のCO₂を排出するのみです。図１からわかるように、現在、日本の主力電源である火力発電と比べると、20倍以上CO₂排出量が少ないです.これは、再生可能エネルギーと同程度のCO₂排出量です。
        <li>原発は発電コストが安い</li>
          　原発では 10.1 円の発電コス トで 1kwh の電気量が発電できるのに対し、火力発電では 1kwh あたりの電気量の発電のコストが 石炭を使った場合が12.3 円、天然ガスを使った場 合が 13.7 円，石油を使った場合が 30.6〜43.4 円 と、どの燃料を使っても火力発電よりも安く発電ができる．実際に原発で電気代が少なくなる事例としては、図 2 より 2017 年に関西電力が 2 基の原発 を再稼働できたことによる年間約 4000 円の電気 料金の値下げを行ったことが挙げられる。
        <li>資源の確保が安全</li>
        　　原子力発電の燃料となるウランは、石油に比べて政情の安定した国々に埋蔵されているため、資源の安定確保が可能です。石油は、中東などの政治が不安定な地域に埋蔵されています。一方ウランは、アメリカなどの、比較的安定した地域に埋蔵されています。
       </ul>
       
          

   
  </body>
</html>
  
  <!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
</head>
<body>
<p>「投票」ボタンを押すと、値を(+1)します。</p>
賛成
<button id="btn1">投票</button>
<input type="text" id="local1" size=2><br>
反対
<button id="btn2">投票</button>
<input type="text" id="local2" size=2><br>
どちらでもない
<button id="btn3">投票</button>
<input type="text" id="local3" size=2>

<script>
window.onload = () => {
const Local1 = document.querySelector("#local1");
const Local2 = document.querySelector("#local2");
const Local3 = document.querySelector("#local3");
const key1 = "touhyou1"; addStorage(key1, Local1, 0);
const key2 = "touhyou2"; addStorage(key2, Local2, 0);
const key3 = "touhyou3"; addStorage(key3, Local3, 0);
/* ボタン1をクリック */
document.querySelector("#btn1").addEventListener("click", (e)=>{
addStorage(key1, Local1);
})
document.querySelector("#btn2").addEventListener("click", (e)=>{
})
document.querySelector("#btn3").addEventListener("click", (e)=>{
})
}

function addStorage(key, display, plus=1){
const buff = localStorage.getItem( key ); // キーの値を取得
if( buff === null ){ // (初期設定)
localStorage.setItem(key, 0);
display.value = 0; // テキストボックスに表示
} else {
let value = Number(buff) + plus;
localStorage.setItem(key, value); // 値を保存する
display.value = value; // テキストボックスに表示
}
}
  
  
  
</script>
</body>
</html>
  
 #! /usr/bin/perl

# 2019-12-16. ランキング サンプル by SU.
# 2019-12-16 v.1.1. 項目にアンカーを付けた。

# use strict;
### use Encode;
### use utf8;
### my $encoder = find_encoding('utf8');


my $top_page = "index.html";	# エラーの後に戻るページ
my $datafile = "point.dat";	# 投票データを保持するファイル
my $show_list_tmpl = "ranking03.html";	# テンプレート化された表示されるwebページ


my %param;
my @data;

%param = get_param();

read_records();

if( $param{soba} ne "" ){
    update_data($param{soba});
	read_records();
	print "Location:http://$ENV{SERVER_NAME}$ENV{SCRIPT_NAME}#$param{soba}\n\n"
}else{
	show_list();
}
exit;



################### subroutines ##################
sub update_data
{
	my $soba =$_[0];
	$soba =~ s/\s+//g;	# 空白は削除
	
	my $flag = 0;
	
	foreach (@data){
		if( $_->{soba} eq $soba ){
			$flag = 1;
			$_->{point} += 1;
		}
	}
	
	# $filenameに存在しない項目の場合は何もしない。
	if( $flag == 0 ){ return; }

	# 並べ替えてランキングを計算
	ranking();

	# 書き込みモードでファイルを開く
	open(OUT, ">$datafile") || &error("Cannot open $datafile: $!");

	foreach (@data){
		if( $_->{soba} eq "" ){ next; }
		print OUT "$_->{soba}\t$_->{ranking}\t$_->{point}\t$_->{name}\t$_->{image}\t$_->{comment}\n";
	}
	# ファイルを閉じる
	close(OUT);
}



# ポイント順に並べ替えて、順位を計算
sub ranking
{
	my( $rank,  $prev_point );
	
	# @dataをpointで降順で並べ替え
	@data = sort{$b->{point} <=> $a->{point}} @data;
	
	for(my $i = 0; $i < @data; $i++ ){
		if( $i == 0 ){
			$rank = 1;
			$data[$i]->{ranking} = $rank;
			$prev_point = $data[$i]->{point};
			next;
		}
		if( $data[$i]->{point} < $prev_point ){
			++$rank;
			$prev_point = $data[$i]->{point};
		}
		$data[$i]->{ranking} = $rank;
	}
}



sub read_records
{
	my( $soba, $ranking, $point, $name, $image, $comment);

	@data =();	# @dataを初期化

	# 読み取りモードでファイルを開く
	open(IN, "<$datafile") || &error("Cannot read $datafile: $!");

	while(<IN>){
		chomp;
		( $soba, $ranking, $point, $name, $image, $comment ) = split(/\t/, $_);
		# 無名ハッシュを配列にする
		push  @data, 
		{ 
			'soba'=>$soba,
			'ranking'=>$ranking,
			'point'=>$point,
			'name'=>$name,
			'image'=>$image,
			'comment'=>$comment
		};
	}
	# ファイルを閉じる
	close(IN);

}



sub show_list
{
	my $table_list;
	
	foreach (@data){
		my $item = <<"_ITEM_";

    <!-- $_->{name} 始まり -->
    <a name="$_->{soba}"></a>
    <dt>$_->{ranking}位($_->{point}ポイント) $_->{name}</dt>
    <dd>
      <img src="./img/$_->{image}" width="200" align="center" alt="$_->{name}" >
      <form method="POST" action="$ENV{SCRIPT_NAME}">
        <input type="hidden" name="soba" value="$_->{soba}">
        <input type="submit" class="vote" value="コレをよく注文する！">
      </form>
      <p>$_->{comment}</p>
    </dd>
    <!-- $_->{name} 終わり -->

_ITEM_
		$table_list .=  $item;
	}


	# 読み取りモードでファイルを開く
	open(IN, "<$show_list_tmpl") || &error("Cannot read $show_list_tmpl: $!");

	print "Content-Type: text/html;charset=Shift_JIS;\n\n";
	
	while(<IN>){
		s/<!--TABLE_LIST-->/$table_list/;
		print $_;
	}
}



########### CGIの基本処理 #############
# 入力データの取得
sub get_param
{
	my($query, $key, $value, %param);

	if($ENV{REQUEST_METHOD} eq "GET"){
		$query = $ENV{QUERY_STRING};
	}else{
		read(STDIN, $query, $ENV{CONTENT_LENGTH});
	}


	foreach(split(/&/, $query)){
		($key, $value) = split(/=/, $_);
		$value =~ s/\+/ /g;
		$value =~ s/%([\da-f][\da-f])/pack("C", hex($1))/egi;
		### $value = $encoder->decode($value);
		$value =~ s/\r//g;
		$param{$key} = $value;
	}
	return %param;
}



# エラー表示
sub error
{
	print "Content-Type: text/html\n\n";
	print <<"---EOF---";
<html><head><title>Information</title></head>
<body>
<span sylte="color: red;"> $_[0]</span>
<form method="GET" action="$top_page">
<input type=SUBMIT value="最初のページに戻る">
</form>
</body></html>
---EOF---
	exit;
}
